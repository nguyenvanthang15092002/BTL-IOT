{"ast":null,"code":"var _jsxFileName = \"E:\\\\CongNgheThongTinBk\\\\20221\\\\IotVaUngDung\\\\btl\\\\Nhom10\\\\sourcecode\\\\iot-web-fe\\\\src\\\\screens\\\\Devices\\\\context.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport { createContext, useContext, useEffect, useMemo, useState } from \"react\";\nimport { toastError, toastSuccess } from \"../../constant/toast\";\nimport { addDeviceByIdFetch, deleteDeviceById, getDeviceById, getUserDevices, updateDeviceByIdFetch } from \"../../services/devicesServices\";\n\n//context\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const DevicesContext = /*#__PURE__*/createContext({});\n\n//hook\nexport const useDevicesContext = () => {\n  _s();\n  return useContext(DevicesContext);\n};\n\n//provider\n_s(useDevicesContext, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nexport const DevicesContextProvider = _ref => {\n  _s2();\n  let {\n    children\n  } = _ref;\n  const [listDevices, setListDevices] = useState([]);\n  const [openModal, setOpenModal] = useState(false);\n  const [deviceItem, setDeviceItem] = useState();\n  const [openAddModal, setOpenAddModal] = useState(false);\n  useEffect(() => {\n    getListDevices();\n  }, []);\n  const getListDevices = async () => {\n    const res = await getUserDevices();\n    setListDevices(res === null || res === void 0 ? void 0 : res.devices);\n  };\n  const deleteDevice = async id => {\n    const res = await deleteDeviceById(id);\n    if (!(res === null || res === void 0 ? void 0 : res.error)) {\n      toastSuccess(\"Delete Complete!\");\n      setTimeout(() => {\n        window.location.reload();\n      }, 2000);\n    } else {\n      toastError(\"Delete Incomplete!\");\n    }\n  };\n  const updateDevice = async (id, name, state) => {\n    let tmp = `{ \"deviceName\": \"${name}\", \"connectState\": \"${state}\" }`;\n    let params = JSON.parse(tmp);\n    // const res = await updateDeviceById(id, params)\n    const res = await updateDeviceByIdFetch(id, params);\n    if (!(res === null || res === void 0 ? void 0 : res.error)) {\n      toastSuccess(\"Update Complete!\");\n      await getListDevices();\n      window.location.reload();\n    } else {\n      toastError(\"Update Incomplete!\");\n    }\n  };\n  const addDevice = async (id, name, state) => {\n    let currentPosition = [];\n    navigator.geolocation.getCurrentPosition(async function (pos) {\n      var _pos$coords, _pos$coords2, _pos$coords3, _pos$coords4;\n      currentPosition.push(pos === null || pos === void 0 ? void 0 : (_pos$coords = pos.coords) === null || _pos$coords === void 0 ? void 0 : _pos$coords.latitude);\n      currentPosition.push(pos === null || pos === void 0 ? void 0 : (_pos$coords2 = pos.coords) === null || _pos$coords2 === void 0 ? void 0 : _pos$coords2.longitude);\n      let tmp = `{ \"embedId\": \"${id}\", \"deviceName\": \"${name}\", \"connectState\": \"OFF\"}`;\n      let params = JSON.parse(tmp);\n      params.location = [pos === null || pos === void 0 ? void 0 : (_pos$coords3 = pos.coords) === null || _pos$coords3 === void 0 ? void 0 : _pos$coords3.latitude, pos === null || pos === void 0 ? void 0 : (_pos$coords4 = pos.coords) === null || _pos$coords4 === void 0 ? void 0 : _pos$coords4.longitude];\n      const res = await addDeviceByIdFetch(params);\n      if (!(res === null || res === void 0 ? void 0 : res.error)) {\n        toastSuccess(\"Add Complete!\");\n        await getListDevices();\n        window.location.reload();\n      } else {\n        toastError(\"Add Incomplete!\");\n      }\n    });\n  };\n  const getDeviceItemById = async id => {\n    let tmp = await getDeviceById(id);\n    if (tmp === null || tmp === void 0 ? void 0 : tmp.device) setDeviceItem(tmp === null || tmp === void 0 ? void 0 : tmp.device);\n  };\n  const value = useMemo(() => ({\n    listDevices,\n    getListDevices,\n    deleteDevice,\n    updateDevice,\n    openModal,\n    setOpenModal,\n    getDeviceItemById,\n    deviceItem,\n    openAddModal,\n    setOpenAddModal,\n    addDevice\n  }),\n  // eslint-disable-next-line no-sequences\n  [listDevices, openModal, deviceItem, openAddModal]);\n  return /*#__PURE__*/_jsxDEV(DevicesContext.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 88,\n    columnNumber: 5\n  }, this);\n};\n_s2(DevicesContextProvider, \"Dam+2oqZqT4gJdv57KIR4pSwYs8=\");\n_c = DevicesContextProvider;\nvar _c;\n$RefreshReg$(_c, \"DevicesContextProvider\");","map":{"version":3,"names":["createContext","useContext","useEffect","useMemo","useState","toastError","toastSuccess","addDeviceByIdFetch","deleteDeviceById","getDeviceById","getUserDevices","updateDeviceByIdFetch","DevicesContext","useDevicesContext","DevicesContextProvider","children","listDevices","setListDevices","openModal","setOpenModal","deviceItem","setDeviceItem","openAddModal","setOpenAddModal","getListDevices","res","devices","deleteDevice","id","error","setTimeout","window","location","reload","updateDevice","name","state","tmp","params","JSON","parse","addDevice","currentPosition","navigator","geolocation","getCurrentPosition","pos","push","coords","latitude","longitude","getDeviceItemById","device","value"],"sources":["E:/CongNgheThongTinBk/20221/IotVaUngDung/btl/Nhom10/sourcecode/iot-web-fe/src/screens/Devices/context.js"],"sourcesContent":["import { createContext, useContext, useEffect, useMemo, useState } from \"react\";\r\nimport { toastError, toastSuccess } from \"../../constant/toast\";\r\nimport { addDeviceByIdFetch, deleteDeviceById, getDeviceById, getUserDevices, updateDeviceByIdFetch } from \"../../services/devicesServices\";\r\n\r\n//context\r\nexport const DevicesContext = createContext({})\r\n\r\n//hook\r\nexport const useDevicesContext = () => useContext(DevicesContext)\r\n\r\n//provider\r\nexport const DevicesContextProvider = ({ children }) => {\r\n  const [listDevices, setListDevices] = useState([])\r\n  const [openModal, setOpenModal] = useState(false)\r\n  const [deviceItem, setDeviceItem] = useState()\r\n  const [openAddModal, setOpenAddModal] = useState(false)\r\n\r\n\r\n  useEffect(() => {\r\n    getListDevices()\r\n\r\n  }, [])\r\n\r\n  const getListDevices = async () => {\r\n    const res = await getUserDevices()\r\n    setListDevices(res?.devices)\r\n  }\r\n\r\n  const deleteDevice = async (id) => {\r\n    const res = await deleteDeviceById(id)\r\n    if (!res?.error) {\r\n      toastSuccess(\"Delete Complete!\")\r\n      setTimeout(() => {\r\n        window.location.reload()\r\n      }, 2000);\r\n    } else {\r\n      toastError(\"Delete Incomplete!\")\r\n    }\r\n  }\r\n\r\n  const updateDevice = async (id, name, state) => {\r\n    let tmp = `{ \"deviceName\": \"${name}\", \"connectState\": \"${state}\" }`\r\n    let params = JSON.parse(tmp)\r\n    // const res = await updateDeviceById(id, params)\r\n    const res = await updateDeviceByIdFetch(id, params)\r\n    if (!res?.error) {\r\n      toastSuccess(\"Update Complete!\")\r\n      await getListDevices()\r\n      window.location.reload()\r\n    } else {\r\n      toastError(\"Update Incomplete!\")\r\n    }\r\n  }\r\n\r\n  const addDevice = async (id, name, state) => {\r\n    let currentPosition = []\r\n    navigator.geolocation.getCurrentPosition(async function (pos) {\r\n      currentPosition.push(pos?.coords?.latitude)\r\n      currentPosition.push(pos?.coords?.longitude)\r\n      let tmp = `{ \"embedId\": \"${id}\", \"deviceName\": \"${name}\", \"connectState\": \"OFF\"}`\r\n      let params = JSON.parse(tmp)\r\n      params.location = [pos?.coords?.latitude, pos?.coords?.longitude]\r\n      const res = await addDeviceByIdFetch(params)\r\n      if (!res?.error) {\r\n        toastSuccess(\"Add Complete!\")\r\n        await getListDevices()\r\n        window.location.reload()\r\n      } else {\r\n        toastError(\"Add Incomplete!\")\r\n      }\r\n    })\r\n\r\n\r\n  }\r\n\r\n  const getDeviceItemById = async (id) => {\r\n    let tmp = await getDeviceById(id)\r\n    if (tmp?.device) setDeviceItem(tmp?.device)\r\n  }\r\n\r\n  const value = useMemo(() => ({\r\n    listDevices, getListDevices, deleteDevice, updateDevice, openModal,\r\n    setOpenModal, getDeviceItemById, deviceItem, openAddModal, setOpenAddModal, addDevice\r\n  }),\r\n    // eslint-disable-next-line no-sequences\r\n    [listDevices, openModal, deviceItem, openAddModal])\r\n  return (\r\n    <DevicesContext.Provider value={value}>\r\n      {children}\r\n    </DevicesContext.Provider>\r\n  )\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}